<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Desafio WIT</title>
    <style>
        /* --- CORES E RESET --- */
        :root {
            --primary-green: #4CAF50;
            --light-green: #E8F5E9; 
            --dark-green: #2E7D32;
            --accent-green: #76FF03; /* Verde neon para sele√ß√£o */
            --alexa-bg: #263238;
            --alexa-light: #00E5FF;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Verdana', 'Segoe UI', sans-serif;
            background-color: var(--light-green);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: #333;
            /* Melhor toque no celular */
            touch-action: manipulation; 
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        /* --- CABE√áALHO --- */
        header {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            background: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            z-index: 100;
        }

        .logo-img {
            max-width: 120px;
            height: auto;
            display: block;
        }

        /* --- PERSONAGEM ALEXA --- */
        .alexa-container {
            margin-top: 5px;
            transform: scale(0.9);
        }

        .alexa-body {
            width: 70px;
            height: 70px;
            background: radial-gradient(circle at 30% 30%, #455A64, #263238);
            border-radius: 50%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            border-bottom: 3px solid var(--alexa-light);
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }

        .alexa-face { width: 60%; height: 40%; position: relative; }
        .eyes { display: flex; justify-content: space-between; width: 100%; }
        .eye { width: 8px; height: 8px; background-color: var(--alexa-light); border-radius: 50%; animation: blink 4s infinite; }
        .mouth { width: 20px; height: 10px; border-bottom: 2px solid var(--alexa-light); border-radius: 0 0 20px 20px; margin: 3px auto 0; }
        @keyframes blink { 0%, 96%, 100% { transform: scaleY(1); } 98% { transform: scaleY(0.1); } }

        .speech-bubble {
            background: white; padding: 8px 15px; border-radius: 15px;
            border: 2px solid var(--primary-green); color: var(--dark-green);
            font-weight: bold; margin-top: 5px; font-size: 0.9rem; text-align: center;
            position: relative; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* --- TELAS --- */
        .screen { display: none; width: 100%; flex-direction: column; align-items: center; padding-bottom: 40px; }
        .screen.active { display: flex; }

        /* MENU INICIAL */
        .menu-content {
            text-align: center;
            margin-top: 20px;
            width: 90%;
            max-width: 400px;
        }
        
        .big-btn {
            background-color: var(--primary-green);
            color: white; border: none; padding: 20px; width: 100%;
            font-size: 1.3rem; border-radius: 15px; cursor: pointer;
            margin: 15px 0; font-weight: bold;
            box-shadow: 0 6px 0 var(--dark-green);
            transition: transform 0.1s;
            display: flex; align-items: center; justify-content: center; gap: 10px;
        }
        .big-btn:active { transform: translateY(6px); box-shadow: none; }
        .big-btn span { font-size: 1.5rem; }

        /* --- √ÅREA DO JOGO --- */
        .game-layout {
            display: flex;
            flex-direction: column; 
            align-items: center;
            width: 100%;
            max-width: 1200px;
            gap: 20px;
            margin-top: 10px;
        }

        /* NO PC (TELA GRANDE) */
        @media (min-width: 800px) {
            .game-layout {
                flex-direction: row; 
                align-items: flex-start;
                justify-content: center;
                padding: 20px;
            }
            .arrow-container { display: none !important; }
            .left-panel { flex: 2; display: flex; flex-direction: column; align-items: center; }
            .right-panel { flex: 1; max-width: 300px; }
        }

        .timer-display {
            font-size: 1.5rem; font-weight: bold; color: var(--dark-green);
            background: white; padding: 5px 20px; border-radius: 20px;
            border: 2px solid var(--primary-green); margin-bottom: 10px;
        }

        /* --- GRADE DO JOGO --- */
        #word-grid {
            display: grid;
            background-color: white;
            padding: 5px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            user-select: none;
            touch-action: none;
            width: 96vw; /* Ocupa quase toda a largura no celular */
            max-width: 600px; 
            aspect-ratio: 1;
        }

        .grid-cell {
            display: flex; justify-content: center; align-items: center;
            font-weight: bold; cursor: pointer; text-transform: uppercase;
            background-color: #fff; 
            border: 1px solid #eee;
            border-radius: 4px;
            /* Fonte responsiva grande */
            font-size: clamp(14px, 4vw, 30px); 
            color: #444;
        }

        .grid-cell.selected { background-color: var(--accent-green); color: #000; border-color: #333; }
        .grid-cell.found { background-color: var(--dark-green) !important; color: white !important; animation: pop 0.3s; }
        @keyframes pop { 50% { transform: scale(1.2); } }

        /* --- SETA (MOBILE) --- */
        .arrow-container {
            width: 100%; text-align: center; margin: 10px 0;
            animation: bounce 1.5s infinite;
        }
        @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-10px);} }

        .arrow-text {
            background: var(--primary-green); color: white;
            padding: 5px 15px; border-radius: 20px; font-weight: bold;
            display: inline-block; margin-bottom: 5px; font-size: 0.9rem;
        }
        .arrow-icon { font-size: 3rem; color: var(--primary-green); line-height: 0.8; text-shadow: 0 2px 0 var(--dark-green); }

        /* --- LISTA --- */
        .words-panel {
            background: white; padding: 15px; border-radius: 15px;
            border: 3px solid var(--primary-green);
            width: 90%; margin: 0 auto;
        }

        .words-panel h3 { margin: 0 0 10px 0; color: var(--dark-green); text-align: center; }

        .words-list {
            list-style: none; padding: 0; margin: 0;
            display: flex; flex-wrap: wrap; justify-content: center; gap: 8px;
        }

        .words-list li {
            padding: 8px 12px; background: #f5f5f5; border-radius: 8px;
            color: #aaa; font-weight: bold; font-size: 0.9rem; border: 1px dashed #ccc;
        }

        .words-list li.revealed {
            background: var(--primary-green); color: white;
            border: 1px solid var(--dark-green); box-shadow: 0 2px 0 var(--dark-green);
            transform: scale(1.05);
        }

        .btn-exit {
            background: #e57373; color: white; border: none; padding: 10px 20px;
            border-radius: 20px; width: 100%; margin-top: 20px; font-weight: bold; font-size: 1rem;
        }

    </style>
</head>
<body>

    <header>
        <img src="logo.png" alt="WIT Logo" class="logo-img">
        <div class="alexa-container">
            <div class="alexa-body">
                <div class="alexa-face">
                    <div class="eyes"><div class="eye"></div><div class="eye"></div></div>
                    <div class="mouth"></div>
                </div>
            </div>
            <div class="speech-bubble" id="alexa-speech">
                Oi! Vamos brincar?
            </div>
        </div>
    </header>

    <div id="menu-screen" class="screen active">
        <div class="menu-content">
            <h2 style="color:var(--dark-green);">Escolha a fase:</h2>
            <p>Toque na primeira letra e arraste o dedo!</p>
            
            <button class="big-btn" onclick="startGame(1)">
                <span>‚≠ê</span> N√≠vel 1 (F√°cil)
            </button>
            
            <button class="big-btn" onclick="startGame(2)">
                <span>üèÜ</span> N√≠vel 2 (Desafio)
            </button>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div class="game-layout">
            
            <div class="left-panel">
                <div class="timer-display">‚è± <span id="timer">00:00</span></div>
                <div id="word-grid"></div>
            </div>

            <div class="arrow-container">
                <div class="arrow-text">Palavras aqui em baixo!</div>
                <div class="arrow-icon">‚¨á</div>
            </div>

            <div class="right-panel">
                <div class="words-panel">
                    <h3>Ache estas palavras:</h3>
                    <ul id="words-list-ui" class="words-list"></ul>
                    <button class="btn-exit" onclick="backToMenu()">Sair do Jogo</button>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- CONFIGURA√á√ÉO ---
        const levels = {
            1: { 
                gridSize: 10, 
                words: ["RELOGIO", "ALEXA", "WIT", "CELULAR", "TABLET"] 
            },
            2: { 
                gridSize: 12, // Reduzi para 12 para as letras ficarem GRANDES
                words: [
                    "RELOGIO", "ALEXA", "WIT", "CELULAR", "TABLET", 
                    "MOUSE", "TECLADO", "DRONE",
                    {clean: "TELEVISAO", show: "TELEVIS√ÉO"}
                ]
            }
        };

        let timerInterval;
        let seconds = 0;
        let isSelecting = false;
        let selectionStart = null;
        let selectedCells = [];
        let audioCtx = null;

        // --- AUDIO ---
        function initAudio() {
            try {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                if (AudioContext && !audioCtx) audioCtx = new AudioContext();
            } catch(e) {}
        }

        function playSound() {
            if (!audioCtx) initAudio();
            if (audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
            if (audioCtx) {
                try {
                    const t = audioCtx.currentTime;
                    const osc = audioCtx.createOscillator();
                    const gain = audioCtx.createGain();
                    osc.type = 'triangle'; 
                    osc.frequency.setValueAtTime(600, t);
                    osc.frequency.linearRampToValueAtTime(1200, t + 0.1);
                    gain.gain.setValueAtTime(0.1, t);
                    gain.gain.linearRampToValueAtTime(0, t + 0.3);
                    osc.connect(gain); gain.connect(audioCtx.destination);
                    osc.start(t); osc.stop(t + 0.3);
                } catch(e) {}
            }
        }

        // --- NAVEGA√á√ÉO ---
        function startGame(level) {
            document.getElementById('menu-screen').classList.remove('active');
            document.getElementById('game-screen').classList.add('active');
            document.getElementById('alexa-speech').innerText = level === 1 ? "N√≠vel 1! Valendo!" : "N√≠vel 2! Mais palavras!";
            window.scrollTo(0,0);
            
            generateGrid(level);
            
            seconds = 0;
            document.getElementById('timer').innerText = "00:00";
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                seconds++;
                const m = Math.floor(seconds / 60).toString().padStart(2, '0');
                const s = (seconds % 60).toString().padStart(2, '0');
                document.getElementById('timer').innerText = `${m}:${s}`;
            }, 1000);

            initAudio();
        }

        function backToMenu() {
            clearInterval(timerInterval);
            document.getElementById('game-screen').classList.remove('active');
            document.getElementById('menu-screen').classList.add('active');
            document.getElementById('alexa-speech').innerText = "Oi! Vamos brincar?";
        }

        // --- JOGO ---
        function generateGrid(level) {
            const config = levels[level];
            const size = config.gridSize;
            
            let wordsToPlace = config.words.map(w => typeof w === 'string' ? {clean: w, show: w} : w);
            
            // Criar e preencher grade
            const grid = Array(size).fill(null).map(() => Array(size).fill(''));
            
            wordsToPlace.forEach(wordObj => {
                let placed = false, attempts = 0;
                while (!placed && attempts < 100) {
                    const dir = Math.random() > 0.5 ? 'H' : 'V';
                    const row = Math.floor(Math.random() * size);
                    const col = Math.floor(Math.random() * size);
                    if (canPlace(grid, wordObj.clean, row, col, dir, size)) {
                        place(grid, wordObj.clean, row, col, dir);
                        placed = true;
                    }
                    attempts++;
                }
            });

            const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            for(let r=0; r<size; r++) for(let c=0; c<size; c++) if(grid[r][c] === '') grid[r][c] = alphabet[Math.floor(Math.random() * alphabet.length)];

            renderGrid(grid, size);
            renderList(wordsToPlace);
        }

        function canPlace(grid, word, row, col, dir, size) {
            if (dir === 'H') {
                if (col + word.length > size) return false;
                for (let i=0; i<word.length; i++) if (grid[row][col+i] !== '' && grid[row][col+i] !== word[i]) return false;
            } else {
                if (row + word.length > size) return false;
                for (let i=0; i<word.length; i++) if (grid[row+i][col] !== '' && grid[row+i][col] !== word[i]) return false;
            }
            return true;
        }

        function place(grid, word, row, col, dir) {
            for (let i=0; i<word.length; i++) dir === 'H' ? grid[row][col+i] = word[i] : grid[row+i][col] = word[i];
        }

        function renderList(words) {
            const ul = document.getElementById('words-list-ui');
            ul.innerHTML = '';
            words.forEach(w => {
                const li = document.createElement('li');
                li.dataset.word = w.clean;
                li.dataset.show = w.show;
                li.innerText = "???"; 
                ul.appendChild(li);
            });
        }

        function renderGrid(grid, size) {
            const container = document.getElementById('word-grid');
            container.innerHTML = '';
            container.style.gridTemplateColumns = `repeat(${size}, 1fr)`;

            grid.forEach((row, r) => row.forEach((char, c) => {
                const div = document.createElement('div');
                div.className = 'grid-cell';
                div.innerText = char;
                div.dataset.r = r;
                div.dataset.c = c;
                div.addEventListener('mousedown', startSelection);
                div.addEventListener('mouseover', updateSelection);
                div.addEventListener('touchstart', (e) => { e.preventDefault(); startSelection(e); }, {passive: false});
                container.appendChild(div);
            }));

            document.body.addEventListener('mouseup', endSelection);
            document.body.addEventListener('touchend', endSelection);
            container.addEventListener('touchmove', handleTouchMove, {passive: false});
        }

        function startSelection(e) {
            isSelecting = true;
            let target = e.target;
            if (e.type === 'touchstart') {
                const touch = e.touches[0];
                target = document.elementFromPoint(touch.clientX, touch.clientY);
            }
            const cell = target ? target.closest('.grid-cell') : null;
            if(cell) {
                selectionStart = { r: parseInt(cell.dataset.r), c: parseInt(cell.dataset.c) };
                updateUI([cell]);
            }
        }

        function handleTouchMove(e) {
            if (!isSelecting) return;
            e.preventDefault();
            const touch = e.touches[0];
            const element = document.elementFromPoint(touch.clientX, touch.clientY);
            if (element && element.closest('.grid-cell')) {
                const cell = element.closest('.grid-cell');
                processRange(cell);
            }
        }

        function updateSelection(e) {
            if (!isSelecting) return;
            const cell = e.target.closest('.grid-cell');
            if(cell) processRange(cell);
        }

        function processRange(cell) {
            if(!selectionStart) return;
            const endR = parseInt(cell.dataset.r);
            const endC = parseInt(cell.dataset.c);
            const startR = selectionStart.r;
            const startC = selectionStart.c;
            
            let cells = [];
            if (startR === endR) {
                const min = Math.min(startC, endC);
                const max = Math.max(startC, endC);
                for(let c=min; c<=max; c++) cells.push(document.querySelector(`.grid-cell[data-r="${startR}"][data-c="${c}"]`));
            } else if (startC === endC) {
                const min = Math.min(startR, endR);
                const max = Math.max(startR, endR);
                for(let r=min; r<=max; r++) cells.push(document.querySelector(`.grid-cell[data-r="${r}"][data-c="${startC}"]`));
            }
            if (cells.length > 0) updateUI(cells);
        }

        function updateUI(cells) {
            document.querySelectorAll('.grid-cell.selected').forEach(c => c.classList.remove('selected'));
            selectedCells = cells;
            cells.forEach(c => c.classList.add('selected'));
        }

        function endSelection() {
            if (!isSelecting) return;
            isSelecting = false;
            
            if(selectedCells.length > 0) {
                const word = selectedCells.map(c => c.innerText).join('');
                const revWord = word.split('').reverse().join('');
                check(word, selectedCells) || check(revWord, selectedCells);
            }
            document.querySelectorAll('.grid-cell.selected').forEach(c => c.classList.remove('selected'));
            selectedCells = [];
            selectionStart = null;
        }

        function check(word, cells) {
            const li = [...document.querySelectorAll('#words-list-ui li')].find(l => l.dataset.word === word && !l.classList.contains('revealed'));
            if (li) {
                li.classList.add('revealed');
                li.innerText = "‚úÖ " + li.dataset.show;
                cells.forEach(c => { c.classList.add('found'); c.classList.remove('selected'); });
                playSound();
                document.getElementById('alexa-speech').innerText = "Boa! Achou: " + li.dataset.show;
                
                if (document.querySelectorAll('#words-list-ui li.revealed').length === document.querySelectorAll('#words-list-ui li').length) {
                    clearInterval(timerInterval);
                    document.getElementById('alexa-speech').innerText = "PARAB√âNS! VOC√ä VENCEU!";
                    setTimeout(playSound, 300);
                }
                return true;
            }
            return false;
        }
    </script>
</body>
</html>